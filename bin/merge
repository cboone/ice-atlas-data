#!/usr/bin/env bash

function main {
  set -e

  local -r start_time="$(date -u '+%Y-%m-%d %H:%M:%S')"
  echo "[merge] Started at $start_time"

  local -r dir="$(pwd)"
  local -r merge_into="$1"
  shift 1

  echo "[merge] Merging regions \"$*\" into \"$merge_into\""

  osmium merge --verbose --overwrite -o "$dir/data/$merge_into.osm.pbf" $(printf "$dir/data/sources/%s.osm.pbf " "$@")
}

main "$@"
