#!/usr/bin/env bash

function main {
  set -e

  local -r start_time="$(date -u '+%Y-%m-%d %H:%M:%S')"
  echo "[update] Started at $start_time"

  local -r dir="$(pwd)"

  local -A regions=(["vt-nh"]=base ["ma-ny-on-qc-nb-me"]=background)

  for region in "${!regions[@]}"; do
    echo "[upload] Uploading $region.pmtiles to r2:skating-atlas/${regions[$region]}.pmtiles"
    rclone copyto --progress "$dir/tiles/$region.pmtiles" "r2:skating-atlas/${regions[$region]}.pmtiles"
  done
}

main "$@"
